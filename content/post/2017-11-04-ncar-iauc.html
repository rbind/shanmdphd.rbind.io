---
title: "NonCompart: How to include iAUC in the tblNCA / How to get descriptive statistics"
author: 'Sungpil Han'
date: '2017-11-04'
bibliography: 'bib.bib'
#output: 
#  bookdown::pdf_document2: default
#  bookdown::tufte_handout2: default
editor_options: 
  chunk_output_type: console
---




<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This document may be temporarily meaningful because the functionality will be included in <code>NonCompart</code> <span class="citation">(Bae 2017)</span> package someday as Prof.Bae said. Until then, I hope that these tips can save several minutes (or hours) for a few people.</p>
<p>One thing we should keep in mind is that the output of <code>tblNCA()</code> is a character matrix so we probably want to change it to <strong>data.frame</strong> (or <strong>tibble</strong>) for the further manipulation and the PK parameters should be converted to numeric by <code>as.numeric()</code> to find descriptive statistics.</p>
<p>These R packages are used.</p>
<pre class="r"><code>library(NonCompart) # for tblNCA(), IntAUC()
library(dplyr) # for data manipulation
library(tidyr) # for data manipulation
library(purrr) # for pmap_dbl()
library(knitr) # make pretty tables (can be ignored when we don&#39;t need them.)</code></pre>

</div>
<div id="how-to-include-iauc-in-the-tblnca" class="section level1">
<h1>How to include iAUC in the tblNCA</h1>
<div id="writing-tblnca2" class="section level2">
<h2>Writing <code>tblNCA2()</code></h2>
<p><code>tblNCA2()</code> is a wrapper function of <code>tblNCA()</code> to include iAUC. In the function, iAUC is calculated by <code>IntAUC()</code>. Data manipulation can be done in numerous ways but I prefer using Hadley’s packages for functional programming <span class="citation">(Henry and Wickham 2017)</span> and tidy data handling <span class="citation">(Wickham and Henry 2017; Wickham et al. 2017)</span>.</p>
<pre class="r"><code>tblNCA2 &lt;- function(concData, key = &quot;Subject&quot;, 
                    colTime = &quot;Time&quot;, colConc = &quot;conc&quot;, 
                    down = &quot;linear&quot;, t1 = 0, t2 = 0, ...){
  # tblNCA() and data calculation
  input_tbl &lt;- tblNCA(as.data.frame(concData), 
                      key, colTime, colConc, down = down, ...) %&gt;% # calculation
    as_tibble() %&gt;% mutate_all(as.character) %&gt;% 
    left_join(concData %&gt;% 
                as_tibble() %&gt;% mutate_all(as.character) %&gt;% 
                group_by_(.dots = key) %&gt;% # grouping by keys (Subject)
                summarise_(x = sprintf(&#39;list(%s)&#39;, colTime), 
                           y = sprintf(&#39;list(%s)&#39;, colConc)))
  
  # calculation of IntAUC()
  output &lt;- input_tbl %&gt;% 
    mutate(Res = do.call(c, input_tbl %&gt;% select(-x, -y) %&gt;% apply(1, list))) %&gt;% 
    mutate(iAUC = pmap_dbl(.l = list(x, y, Res), 
                           .f = ~IntAUC(x = as.numeric(..1), y = as.numeric(..2), 
                                        t1, t2, 
                                        Res = ..3, down = down))) %&gt;% 
    select(-x, -y, -Res) %&gt;% 
    mutate_at(vars(b0:iAUC), as.numeric) # character -&gt; number
  return(output)
}</code></pre>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div id="example-1-datasetstheoph" class="section level3">
<h3>Example 1: datasets::Theoph</h3>
<p>Now we can use <code>tblNCA2()</code> to find NCA parameters and <em>interval AUC between 0-12 hours</em> of Theoph dataset internally available in R.</p>
<pre class="r"><code>Theoph_with_iAUC &lt;- tblNCA2(Theoph, dose = 320, t1 = 0, t2 = 12) # 0-12h
Theoph_with_iAUC %&gt;% 
  kable(caption = &#39;Entire PK parameters calculated by NonCompart&#39;, booktabs=TRUE, digits = 2)</code></pre>
<table>
<caption>
<span id="tab:wide">Table 1: </span>Entire PK parameters calculated by NonCompart
</caption>
<thead>
<tr>
<th style="text-align:left;">
Subject
</th>
<th style="text-align:right;">
b0
</th>
<th style="text-align:right;">
CMAX
</th>
<th style="text-align:right;">
CMAXD
</th>
<th style="text-align:right;">
TMAX
</th>
<th style="text-align:right;">
TLAG
</th>
<th style="text-align:right;">
CLST
</th>
<th style="text-align:right;">
CLSTP
</th>
<th style="text-align:right;">
TLST
</th>
<th style="text-align:right;">
LAMZHL
</th>
<th style="text-align:right;">
LAMZ
</th>
<th style="text-align:right;">
LAMZLL
</th>
<th style="text-align:right;">
LAMZUL
</th>
<th style="text-align:right;">
LAMZNPT
</th>
<th style="text-align:right;">
CORRXY
</th>
<th style="text-align:right;">
R2
</th>
<th style="text-align:right;">
R2ADJ
</th>
<th style="text-align:right;">
AUCLST
</th>
<th style="text-align:right;">
AUCALL
</th>
<th style="text-align:right;">
AUCIFO
</th>
<th style="text-align:right;">
AUCIFOD
</th>
<th style="text-align:right;">
AUCIFP
</th>
<th style="text-align:right;">
AUCIFPD
</th>
<th style="text-align:right;">
AUCPEO
</th>
<th style="text-align:right;">
AUCPEP
</th>
<th style="text-align:right;">
AUMCLST
</th>
<th style="text-align:right;">
AUMCIFO
</th>
<th style="text-align:right;">
AUMCIFP
</th>
<th style="text-align:right;">
AUMCPEO
</th>
<th style="text-align:right;">
AUMCPEP
</th>
<th style="text-align:right;">
VZFO
</th>
<th style="text-align:right;">
VZFP
</th>
<th style="text-align:right;">
CLFO
</th>
<th style="text-align:right;">
CLFP
</th>
<th style="text-align:right;">
MRTEVLST
</th>
<th style="text-align:right;">
MRTEVIFO
</th>
<th style="text-align:right;">
MRTEVIFP
</th>
<th style="text-align:right;">
iAUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
2.37
</td>
<td style="text-align:right;">
10.50
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.28
</td>
<td style="text-align:right;">
3.28
</td>
<td style="text-align:right;">
24.37
</td>
<td style="text-align:right;">
14.30
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
9.05
</td>
<td style="text-align:right;">
24.37
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
148.92
</td>
<td style="text-align:right;">
148.92
</td>
<td style="text-align:right;">
216.61
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
216.61
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
31.25
</td>
<td style="text-align:right;">
31.25
</td>
<td style="text-align:right;">
1459.07
</td>
<td style="text-align:right;">
4505.53
</td>
<td style="text-align:right;">
4505.67
</td>
<td style="text-align:right;">
67.62
</td>
<td style="text-align:right;">
67.62
</td>
<td style="text-align:right;">
30486.75
</td>
<td style="text-align:right;">
30486.32
</td>
<td style="text-align:right;">
1477.30
</td>
<td style="text-align:right;">
1477.28
</td>
<td style="text-align:right;">
9.80
</td>
<td style="text-align:right;">
20.80
</td>
<td style="text-align:right;">
20.80
</td>
<td style="text-align:right;">
91.74
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
8.33
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
24.30
</td>
<td style="text-align:right;">
6.66
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
7.03
</td>
<td style="text-align:right;">
24.30
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
91.53
</td>
<td style="text-align:right;">
91.53
</td>
<td style="text-align:right;">
100.17
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
100.06
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
8.63
</td>
<td style="text-align:right;">
8.53
</td>
<td style="text-align:right;">
706.59
</td>
<td style="text-align:right;">
999.77
</td>
<td style="text-align:right;">
996.07
</td>
<td style="text-align:right;">
29.33
</td>
<td style="text-align:right;">
29.06
</td>
<td style="text-align:right;">
30690.44
</td>
<td style="text-align:right;">
30723.92
</td>
<td style="text-align:right;">
3194.46
</td>
<td style="text-align:right;">
3197.94
</td>
<td style="text-align:right;">
7.72
</td>
<td style="text-align:right;">
9.98
</td>
<td style="text-align:right;">
9.95
</td>
<td style="text-align:right;">
67.48
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
2.53
</td>
<td style="text-align:right;">
8.20
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:right;">
24.17
</td>
<td style="text-align:right;">
6.77
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
9.00
</td>
<td style="text-align:right;">
24.17
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
99.29
</td>
<td style="text-align:right;">
99.29
</td>
<td style="text-align:right;">
109.54
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
109.59
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
9.36
</td>
<td style="text-align:right;">
9.40
</td>
<td style="text-align:right;">
803.19
</td>
<td style="text-align:right;">
1150.96
</td>
<td style="text-align:right;">
1152.65
</td>
<td style="text-align:right;">
30.22
</td>
<td style="text-align:right;">
30.32
</td>
<td style="text-align:right;">
28517.10
</td>
<td style="text-align:right;">
28504.15
</td>
<td style="text-align:right;">
2921.41
</td>
<td style="text-align:right;">
2920.09
</td>
<td style="text-align:right;">
8.09
</td>
<td style="text-align:right;">
10.51
</td>
<td style="text-align:right;">
10.52
</td>
<td style="text-align:right;">
70.18
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
2.59
</td>
<td style="text-align:right;">
8.60
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1.07
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
1.16
</td>
<td style="text-align:right;">
24.65
</td>
<td style="text-align:right;">
6.98
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
9.02
</td>
<td style="text-align:right;">
24.65
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
106.80
</td>
<td style="text-align:right;">
106.80
</td>
<td style="text-align:right;">
118.38
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
118.44
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
9.78
</td>
<td style="text-align:right;">
9.83
</td>
<td style="text-align:right;">
901.08
</td>
<td style="text-align:right;">
1303.25
</td>
<td style="text-align:right;">
1305.50
</td>
<td style="text-align:right;">
30.86
</td>
<td style="text-align:right;">
30.98
</td>
<td style="text-align:right;">
27225.96
</td>
<td style="text-align:right;">
27211.10
</td>
<td style="text-align:right;">
2703.18
</td>
<td style="text-align:right;">
2701.71
</td>
<td style="text-align:right;">
8.44
</td>
<td style="text-align:right;">
11.01
</td>
<td style="text-align:right;">
11.02
</td>
<td style="text-align:right;">
73.05
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
2.55
</td>
<td style="text-align:right;">
11.40
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.57
</td>
<td style="text-align:right;">
1.56
</td>
<td style="text-align:right;">
24.35
</td>
<td style="text-align:right;">
8.00
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
7.02
</td>
<td style="text-align:right;">
24.35
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
121.29
</td>
<td style="text-align:right;">
121.29
</td>
<td style="text-align:right;">
139.42
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
139.25
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
13.00
</td>
<td style="text-align:right;">
12.90
</td>
<td style="text-align:right;">
1017.11
</td>
<td style="text-align:right;">
1667.72
</td>
<td style="text-align:right;">
1661.79
</td>
<td style="text-align:right;">
39.01
</td>
<td style="text-align:right;">
38.79
</td>
<td style="text-align:right;">
26497.99
</td>
<td style="text-align:right;">
26529.42
</td>
<td style="text-align:right;">
2295.23
</td>
<td style="text-align:right;">
2297.95
</td>
<td style="text-align:right;">
8.39
</td>
<td style="text-align:right;">
11.96
</td>
<td style="text-align:right;">
11.93
</td>
<td style="text-align:right;">
84.61
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
2.03
</td>
<td style="text-align:right;">
6.44
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
23.85
</td>
<td style="text-align:right;">
7.89
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
2.03
</td>
<td style="text-align:right;">
23.85
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
73.78
</td>
<td style="text-align:right;">
73.78
</td>
<td style="text-align:right;">
84.25
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
84.50
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
12.44
</td>
<td style="text-align:right;">
12.69
</td>
<td style="text-align:right;">
609.15
</td>
<td style="text-align:right;">
978.43
</td>
<td style="text-align:right;">
986.97
</td>
<td style="text-align:right;">
37.74
</td>
<td style="text-align:right;">
38.28
</td>
<td style="text-align:right;">
43259.73
</td>
<td style="text-align:right;">
43135.69
</td>
<td style="text-align:right;">
3798.02
</td>
<td style="text-align:right;">
3787.13
</td>
<td style="text-align:right;">
8.26
</td>
<td style="text-align:right;">
11.61
</td>
<td style="text-align:right;">
11.68
</td>
<td style="text-align:right;">
51.76
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:right;">
7.09
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
3.48
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
1.16
</td>
<td style="text-align:right;">
24.22
</td>
<td style="text-align:right;">
7.85
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
6.98
</td>
<td style="text-align:right;">
24.22
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
90.75
</td>
<td style="text-align:right;">
90.75
</td>
<td style="text-align:right;">
103.77
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
103.89
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
12.55
</td>
<td style="text-align:right;">
12.65
</td>
<td style="text-align:right;">
782.42
</td>
<td style="text-align:right;">
1245.10
</td>
<td style="text-align:right;">
1249.41
</td>
<td style="text-align:right;">
37.16
</td>
<td style="text-align:right;">
37.38
</td>
<td style="text-align:right;">
34908.44
</td>
<td style="text-align:right;">
34867.67
</td>
<td style="text-align:right;">
3083.69
</td>
<td style="text-align:right;">
3080.09
</td>
<td style="text-align:right;">
8.62
</td>
<td style="text-align:right;">
12.00
</td>
<td style="text-align:right;">
12.03
</td>
<td style="text-align:right;">
62.10
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
2.17
</td>
<td style="text-align:right;">
7.56
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
2.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
1.23
</td>
<td style="text-align:right;">
24.12
</td>
<td style="text-align:right;">
8.51
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
3.53
</td>
<td style="text-align:right;">
24.12
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
88.56
</td>
<td style="text-align:right;">
88.56
</td>
<td style="text-align:right;">
103.91
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
103.64
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
14.77
</td>
<td style="text-align:right;">
14.55
</td>
<td style="text-align:right;">
739.53
</td>
<td style="text-align:right;">
1298.12
</td>
<td style="text-align:right;">
1288.52
</td>
<td style="text-align:right;">
43.03
</td>
<td style="text-align:right;">
42.61
</td>
<td style="text-align:right;">
37810.51
</td>
<td style="text-align:right;">
37906.69
</td>
<td style="text-align:right;">
3079.69
</td>
<td style="text-align:right;">
3087.52
</td>
<td style="text-align:right;">
8.35
</td>
<td style="text-align:right;">
12.49
</td>
<td style="text-align:right;">
12.43
</td>
<td style="text-align:right;">
62.71
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
2.12
</td>
<td style="text-align:right;">
9.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
24.43
</td>
<td style="text-align:right;">
8.41
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
8.80
</td>
<td style="text-align:right;">
24.43
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
86.33
</td>
<td style="text-align:right;">
86.33
</td>
<td style="text-align:right;">
99.91
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
99.87
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
13.59
</td>
<td style="text-align:right;">
13.56
</td>
<td style="text-align:right;">
705.23
</td>
<td style="text-align:right;">
1201.77
</td>
<td style="text-align:right;">
1200.21
</td>
<td style="text-align:right;">
41.32
</td>
<td style="text-align:right;">
41.24
</td>
<td style="text-align:right;">
38842.79
</td>
<td style="text-align:right;">
38859.38
</td>
<td style="text-align:right;">
3202.92
</td>
<td style="text-align:right;">
3204.29
</td>
<td style="text-align:right;">
8.17
</td>
<td style="text-align:right;">
12.03
</td>
<td style="text-align:right;">
12.02
</td>
<td style="text-align:right;">
60.12
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
2.66
</td>
<td style="text-align:right;">
10.21
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
3.55
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.42
</td>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
23.70
</td>
<td style="text-align:right;">
9.25
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
9.38
</td>
<td style="text-align:right;">
23.70
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
138.37
</td>
<td style="text-align:right;">
138.37
</td>
<td style="text-align:right;">
170.65
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
170.57
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
18.92
</td>
<td style="text-align:right;">
18.88
</td>
<td style="text-align:right;">
1278.18
</td>
<td style="text-align:right;">
2473.99
</td>
<td style="text-align:right;">
2470.88
</td>
<td style="text-align:right;">
48.34
</td>
<td style="text-align:right;">
48.27
</td>
<td style="text-align:right;">
25015.54
</td>
<td style="text-align:right;">
25027.88
</td>
<td style="text-align:right;">
1875.16
</td>
<td style="text-align:right;">
1876.09
</td>
<td style="text-align:right;">
9.24
</td>
<td style="text-align:right;">
14.50
</td>
<td style="text-align:right;">
14.49
</td>
<td style="text-align:right;">
90.82
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:right;">
2.15
</td>
<td style="text-align:right;">
8.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
24.08
</td>
<td style="text-align:right;">
7.26
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
9.03
</td>
<td style="text-align:right;">
24.08
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
80.09
</td>
<td style="text-align:right;">
80.09
</td>
<td style="text-align:right;">
89.10
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
89.10
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
10.11
</td>
<td style="text-align:right;">
10.11
</td>
<td style="text-align:right;">
617.24
</td>
<td style="text-align:right;">
928.56
</td>
<td style="text-align:right;">
928.49
</td>
<td style="text-align:right;">
33.53
</td>
<td style="text-align:right;">
33.52
</td>
<td style="text-align:right;">
37622.19
</td>
<td style="text-align:right;">
37623.04
</td>
<td style="text-align:right;">
3591.36
</td>
<td style="text-align:right;">
3591.44
</td>
<td style="text-align:right;">
7.71
</td>
<td style="text-align:right;">
10.42
</td>
<td style="text-align:right;">
10.42
</td>
<td style="text-align:right;">
58.54
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
2.82
</td>
<td style="text-align:right;">
9.75
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
3.52
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.17
</td>
<td style="text-align:right;">
1.18
</td>
<td style="text-align:right;">
24.15
</td>
<td style="text-align:right;">
6.29
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
9.03
</td>
<td style="text-align:right;">
24.15
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
119.98
</td>
<td style="text-align:right;">
119.98
</td>
<td style="text-align:right;">
130.59
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
130.64
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
8.13
</td>
<td style="text-align:right;">
8.16
</td>
<td style="text-align:right;">
977.88
</td>
<td style="text-align:right;">
1330.38
</td>
<td style="text-align:right;">
1332.05
</td>
<td style="text-align:right;">
26.50
</td>
<td style="text-align:right;">
26.59
</td>
<td style="text-align:right;">
22224.29
</td>
<td style="text-align:right;">
22215.75
</td>
<td style="text-align:right;">
2450.44
</td>
<td style="text-align:right;">
2449.50
</td>
<td style="text-align:right;">
8.15
</td>
<td style="text-align:right;">
10.19
</td>
<td style="text-align:right;">
10.20
</td>
<td style="text-align:right;">
85.02
</td>
</tr>
</tbody>
</table>
<p>Table <a href="#tab:wide">1</a> is so wide that we may want to focus on C<sub>max</sub>, T<sub>max</sub>, AUC<sub>last</sub>, AUC<sub>inf</sub>, and iAUC. Table <a href="#tab:pkparam">2</a> looks okay. We can compare the values with the concentration-time curves in Figure <a href="#fig:ggfig">1</a></p>
<pre class="r"><code>Theoph_with_iAUC_selected &lt;- Theoph_with_iAUC %&gt;% 
  select(Subject, CMAX, TMAX, AUCLST, AUCIFO, iAUC) 

Theoph_with_iAUC_selected %&gt;% 
  kable(caption = &#39;Selected PK parameters including iAUC&#39;, booktabs=TRUE, digits = 2)</code></pre>
<table>
<caption>
<span id="tab:pkparam">Table 2: </span>Selected PK parameters including iAUC
</caption>
<thead>
<tr>
<th style="text-align:left;">
Subject
</th>
<th style="text-align:right;">
CMAX
</th>
<th style="text-align:right;">
TMAX
</th>
<th style="text-align:right;">
AUCLST
</th>
<th style="text-align:right;">
AUCIFO
</th>
<th style="text-align:right;">
iAUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
10.50
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
148.92
</td>
<td style="text-align:right;">
216.61
</td>
<td style="text-align:right;">
91.74
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
8.33
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:right;">
91.53
</td>
<td style="text-align:right;">
100.17
</td>
<td style="text-align:right;">
67.48
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
8.20
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:right;">
99.29
</td>
<td style="text-align:right;">
109.54
</td>
<td style="text-align:right;">
70.18
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
8.60
</td>
<td style="text-align:right;">
1.07
</td>
<td style="text-align:right;">
106.80
</td>
<td style="text-align:right;">
118.38
</td>
<td style="text-align:right;">
73.05
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
11.40
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
121.29
</td>
<td style="text-align:right;">
139.42
</td>
<td style="text-align:right;">
84.61
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
6.44
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
73.78
</td>
<td style="text-align:right;">
84.25
</td>
<td style="text-align:right;">
51.76
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
7.09
</td>
<td style="text-align:right;">
3.48
</td>
<td style="text-align:right;">
90.75
</td>
<td style="text-align:right;">
103.77
</td>
<td style="text-align:right;">
62.10
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
7.56
</td>
<td style="text-align:right;">
2.02
</td>
<td style="text-align:right;">
88.56
</td>
<td style="text-align:right;">
103.91
</td>
<td style="text-align:right;">
62.71
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
9.03
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
86.33
</td>
<td style="text-align:right;">
99.91
</td>
<td style="text-align:right;">
60.12
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
10.21
</td>
<td style="text-align:right;">
3.55
</td>
<td style="text-align:right;">
138.37
</td>
<td style="text-align:right;">
170.65
</td>
<td style="text-align:right;">
90.82
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:right;">
8.00
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
80.09
</td>
<td style="text-align:right;">
89.10
</td>
<td style="text-align:right;">
58.54
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
9.75
</td>
<td style="text-align:right;">
3.52
</td>
<td style="text-align:right;">
119.98
</td>
<td style="text-align:right;">
130.59
</td>
<td style="text-align:right;">
85.02
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>library(ggplot2)
ggplot(Theoph %&gt;% left_join(Theoph_with_iAUC), aes(x = Time, y = conc)) +
  geom_line() + 
  geom_point(color = &#39;red&#39;) + 
  facet_wrap(~ sprintf(&#39;Subject %2s,Cmax %0.1f,\nAUClast %0.1f,iAUC %0.1f&#39;, 
                       Subject, CMAX, AUCLST, iAUC), ncol = 4) +
  scale_x_continuous(breaks = c(0, 6, 12, 24)) +
  theme_minimal()</code></pre>
<div class="figure"><span id="fig:ggfig"></span>
<img src="/post/2017-11-04-ncar-iauc_files/figure-html/ggfig-1.png" alt="Individual concentration-time curves" width="672" />
<p class="caption">
Figure 1: Individual concentration-time curves
</p>
</div>
</div>
<div id="example-2-pkpddatasetssd_oral_richpk" class="section level3">
<h3>Example 2: PKPDdatasets::sd_oral_richpk</h3>
<p><code>PKPDdatasets</code> package <span class="citation">(Pastoor 2014)</span> contains some interesting PK/PD datasets and I want to apply <code>tblNCA2()</code> to one of them. In this case, I’ll add some more <em>keys</em> such as gender and race. Factors should be converted to characters and <em>strangely</em> the lower case should be avoided as a input of keys in <code>tblNCA()</code>. Table <a href="#tab:sdoral">3</a> shows the results and multiple keys are working fine. Results of only 10 subjects are shown here out of total 50 subjects.</p>
<pre class="r"><code>sd_oral_richpk_char &lt;- PKPDdatasets::sd_oral_richpk %&gt;% 
  filter(ID &lt;= 12) %&gt;% 
  mutate_at(vars(ID, Gender, Race), function(x) toupper(as.character(x)))

tblNCA2(sd_oral_richpk_char, 
        key = c(&#39;ID&#39;, &#39;Gender&#39;, &#39;Race&#39;), &#39;Time&#39;, &#39;Conc&#39;, dose = 5000, t1 = 0, t2 = 12) %&gt;% 
  select(ID, Gender, Race, CMAX, TMAX, AUCLST, AUCIFO, iAUC) %&gt;% 
  kable(caption = &#39;Selected PK parameters including iAUC of sd oral richpk&#39;, 
        booktabs=TRUE, digits = 2)</code></pre>
<table>
<caption>
<span id="tab:sdoral">Table 3: </span>Selected PK parameters including iAUC of sd oral richpk
</caption>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:left;">
Gender
</th>
<th style="text-align:left;">
Race
</th>
<th style="text-align:right;">
CMAX
</th>
<th style="text-align:right;">
TMAX
</th>
<th style="text-align:right;">
AUCLST
</th>
<th style="text-align:right;">
AUCIFO
</th>
<th style="text-align:right;">
iAUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
HISPANIC
</td>
<td style="text-align:right;">
34.01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
385.58
</td>
<td style="text-align:right;">
449.44
</td>
<td style="text-align:right;">
280.59
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
CAUCASIAN
</td>
<td style="text-align:right;">
100.18
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1203.49
</td>
<td style="text-align:right;">
2495.10
</td>
<td style="text-align:right;">
732.30
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
OTHER
</td>
<td style="text-align:right;">
53.86
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
466.31
</td>
<td style="text-align:right;">
481.99
</td>
<td style="text-align:right;">
389.24
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
FEMALE
</td>
<td style="text-align:left;">
CAUCASIAN
</td>
<td style="text-align:right;">
96.68
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1219.64
</td>
<td style="text-align:right;">
1789.21
</td>
<td style="text-align:right;">
775.31
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
FEMALE
</td>
<td style="text-align:left;">
CAUCASIAN
</td>
<td style="text-align:right;">
51.63
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
487.57
</td>
<td style="text-align:right;">
516.44
</td>
<td style="text-align:right;">
385.18
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
HISPANIC
</td>
<td style="text-align:right;">
27.94
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
295.25
</td>
<td style="text-align:right;">
342.57
</td>
<td style="text-align:right;">
208.93
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
OTHER
</td>
<td style="text-align:right;">
71.81
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
739.03
</td>
<td style="text-align:right;">
876.99
</td>
<td style="text-align:right;">
521.99
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
ASIAN
</td>
<td style="text-align:right;">
44.45
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
453.77
</td>
<td style="text-align:right;">
472.76
</td>
<td style="text-align:right;">
345.15
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
FEMALE
</td>
<td style="text-align:left;">
OTHER
</td>
<td style="text-align:right;">
48.47
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
698.99
</td>
<td style="text-align:right;">
817.67
</td>
<td style="text-align:right;">
435.38
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
OTHER
</td>
<td style="text-align:right;">
23.52
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
161.45
</td>
<td style="text-align:right;">
162.89
</td>
<td style="text-align:right;">
146.59
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
ASIAN
</td>
<td style="text-align:right;">
68.10
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
962.56
</td>
<td style="text-align:right;">
1272.65
</td>
<td style="text-align:right;">
611.06
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
MALE
</td>
<td style="text-align:left;">
OTHER
</td>
<td style="text-align:right;">
83.63
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
721.85
</td>
<td style="text-align:right;">
768.82
</td>
<td style="text-align:right;">
550.52
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="how-to-get-descriptive-statistics" class="section level1">
<h1>How to get descriptive statistics</h1>
<p>You may want to use <code>psych::describe()</code> or <code>broom::tidy()</code> <span class="citation">(Robinson 2017)</span>. They returns basically the same results. One thing to be mentioned is that <code>broom::tidy()</code> returns the descriptive statistics when the input is data.frame so <code>as.data.frame()</code> should be first applied to the output of <code>tblNCA()</code>. (Table <a href="#tab:descstat-iauc">4</a>)</p>
<pre class="r"><code>broom::tidy(as.data.frame(Theoph_with_iAUC_selected)) %&gt;% 
  kable(caption = &#39;Descriptive statistics of selected PK parameters of Theoph&#39;,
        booktabs = TRUE, digits = 2)</code></pre>
<table>
<caption>
<span id="tab:descstat-iauc">Table 4: </span>Descriptive statistics of selected PK parameters of Theoph
</caption>
<thead>
<tr>
<th style="text-align:left;">
column
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
trimmed
</th>
<th style="text-align:right;">
mad
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
range
</th>
<th style="text-align:right;">
skew
</th>
<th style="text-align:right;">
kurtosis
</th>
<th style="text-align:right;">
se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Subject*
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6.50
</td>
<td style="text-align:right;">
3.61
</td>
<td style="text-align:right;">
6.50
</td>
<td style="text-align:right;">
6.50
</td>
<td style="text-align:right;">
4.45
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
12.00
</td>
<td style="text-align:right;">
11.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-1.50
</td>
<td style="text-align:right;">
1.04
</td>
</tr>
<tr>
<td style="text-align:left;">
CMAX
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.76
</td>
<td style="text-align:right;">
1.47
</td>
<td style="text-align:right;">
8.46
</td>
<td style="text-align:right;">
8.73
</td>
<td style="text-align:right;">
1.62
</td>
<td style="text-align:right;">
6.44
</td>
<td style="text-align:right;">
11.40
</td>
<td style="text-align:right;">
4.96
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
-1.19
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.79
</td>
<td style="text-align:right;">
1.11
</td>
<td style="text-align:right;">
1.14
</td>
<td style="text-align:right;">
1.73
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
3.55
</td>
<td style="text-align:right;">
2.92
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
-1.35
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
AUCLST
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
103.81
</td>
<td style="text-align:right;">
23.65
</td>
<td style="text-align:right;">
95.41
</td>
<td style="text-align:right;">
102.30
</td>
<td style="text-align:right;">
19.79
</td>
<td style="text-align:right;">
73.78
</td>
<td style="text-align:right;">
148.92
</td>
<td style="text-align:right;">
75.15
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
-1.12
</td>
<td style="text-align:right;">
6.83
</td>
</tr>
<tr>
<td style="text-align:left;">
AUCIFO
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
122.19
</td>
<td style="text-align:right;">
38.13
</td>
<td style="text-align:right;">
106.72
</td>
<td style="text-align:right;">
116.54
</td>
<td style="text-align:right;">
21.70
</td>
<td style="text-align:right;">
84.25
</td>
<td style="text-align:right;">
216.61
</td>
<td style="text-align:right;">
132.36
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
11.01
</td>
</tr>
<tr>
<td style="text-align:left;">
iAUC
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
71.51
</td>
<td style="text-align:right;">
13.52
</td>
<td style="text-align:right;">
68.83
</td>
<td style="text-align:right;">
71.46
</td>
<td style="text-align:right;">
14.08
</td>
<td style="text-align:right;">
51.76
</td>
<td style="text-align:right;">
91.74
</td>
<td style="text-align:right;">
39.98
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
-1.55
</td>
<td style="text-align:right;">
3.90
</td>
</tr>
</tbody>
</table>
<div id="write-your-own-scripts" class="section level2">
<h2>Write your own scripts</h2>
<p>You can write some codes to customize the descriptive statistics.</p>
<pre class="r"><code>Theoph_tblNCA &lt;- tblNCA(Theoph)

as_tibble(Theoph_tblNCA) %&gt;% 
  gather(PPTESTCD, PPORRES, -Subject) %&gt;% 
  left_join(tibble(PPTESTCD = attr(Theoph_tblNCA, &#39;dimnames&#39;)[[2]], 
                   UNIT = attr(Theoph_tblNCA, &#39;units&#39;)),
          by = &#39;PPTESTCD&#39;) %&gt;% 
  mutate(PPORRES = as.numeric(PPORRES)) %&gt;% 
  group_by(PPTESTCD, UNIT) %&gt;% 
  summarise_at(vars(PPORRES), funs(n(), mean, sd, cv = sd/mean*100,
                                   geomean = PKNCA::geomean, 
                                   geosd = PKNCA::geosd, 
                                   geocv = PKNCA::geocv,
                                   median, min, max)) %&gt;% 
  mutate(`Arithmetic mean ± SD (CV%)` = sprintf(&#39;%0.1f ± %0.1f (%0.1f%%)&#39;, mean, sd, cv)) %&gt;% 
  mutate(`Geometric mean ± SD (CV%)` = sprintf(&#39;%0.1f ± %0.1f (%0.1f%%)&#39;, geomean, geosd, geocv)) %&gt;% 
  mutate(`Median [range]` = sprintf(&#39;%0.1f [%0.1f-%0.1f]&#39;, median, min, max)) %&gt;% 
  select(-mean, -sd, -cv, -geomean, -geosd, -geocv, -median, -min, -max) %&gt;% 
  filter(PPTESTCD %in% c(&#39;CMAX&#39;, &#39;TMAX&#39;, &#39;AUCLST&#39;, &#39;AUCIFO&#39;)) %&gt;% 
  kable(caption = &#39;Descriptive statistics of selected PK parameters manually calculated.&#39;, 
        booktabs = TRUE) </code></pre>
<table>
<caption>
<span id="tab:unnamed-chunk-1">Table 5: </span>Descriptive statistics of selected PK parameters manually calculated.
</caption>
<thead>
<tr>
<th style="text-align:left;">
PPTESTCD
</th>
<th style="text-align:left;">
UNIT
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
Arithmetic mean ± SD (CV%)
</th>
<th style="text-align:left;">
Geometric mean ± SD (CV%)
</th>
<th style="text-align:left;">
Median [range]
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AUCIFO
</td>
<td style="text-align:left;">
h*ug/L
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
122.2 ± 38.1 (31.2%)
</td>
<td style="text-align:left;">
117.7 ± 1.3 (28.0%)
</td>
<td style="text-align:left;">
106.7 [84.3-216.6]
</td>
</tr>
<tr>
<td style="text-align:left;">
AUCLST
</td>
<td style="text-align:left;">
h*ug/L
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
103.8 ± 23.6 (22.8%)
</td>
<td style="text-align:left;">
101.5 ± 1.2 (22.3%)
</td>
<td style="text-align:left;">
95.4 [73.8-148.9]
</td>
</tr>
<tr>
<td style="text-align:left;">
CMAX
</td>
<td style="text-align:left;">
ug/L
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
8.8 ± 1.5 (16.8%)
</td>
<td style="text-align:left;">
8.6 ± 1.2 (17.0%)
</td>
<td style="text-align:left;">
8.5 [6.4-11.4]
</td>
</tr>
<tr>
<td style="text-align:left;">
TMAX
</td>
<td style="text-align:left;">
h
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
1.8 ± 1.1 (62.2%)
</td>
<td style="text-align:left;">
1.5 ± 1.8 (64.7%)
</td>
<td style="text-align:left;">
1.1 [0.6-3.5]
</td>
</tr>
</tbody>
</table>
<p>Although there’s an advantage of customization, the script is quite lengthy, so unless you’re preparing a journal paper, I just recommend using <code>broom::tidy()</code>.</p>

</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-R-NonCompart">
<p>Bae, Kyun-Seop. 2017. <em>NonCompart: Noncompartmental Analysis for Pharmacokinetic Data</em>. <a href="https://CRAN.R-project.org/package=NonCompart" class="uri">https://CRAN.R-project.org/package=NonCompart</a>.</p>
</div>
<div id="ref-R-purrr">
<p>Henry, Lionel, and Hadley Wickham. 2017. <em>Purrr: Functional Programming Tools</em>. <a href="https://CRAN.R-project.org/package=purrr" class="uri">https://CRAN.R-project.org/package=purrr</a>.</p>
</div>
<div id="ref-R-PKPDdatasets">
<p>Pastoor, Devin. 2014. <em>PKPDdatasets: Data Sets for Pharmacometric Analysis and Visualization</em>.</p>
</div>
<div id="ref-R-broom">
<p>Robinson, David. 2017. <em>Broom: Convert Statistical Analysis Objects into Tidy Data Frames</em>. <a href="https://CRAN.R-project.org/package=broom" class="uri">https://CRAN.R-project.org/package=broom</a>.</p>
</div>
<div id="ref-R-tidyr">
<p>Wickham, Hadley, and Lionel Henry. 2017. <em>Tidyr: Easily Tidy Data with ’Spread()’ and ’Gather()’ Functions</em>. <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a>.</p>
</div>
<div id="ref-R-dplyr">
<p>Wickham, Hadley, Romain Francois, Lionel Henry, and Kirill Müller. 2017. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
</div>
</div>
