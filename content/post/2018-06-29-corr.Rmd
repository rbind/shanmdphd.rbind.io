---
title: Correlation Plot
date: 2018-06-29
tag: [R, data science]
---

Correlation plot을 그리는 R 코드입니다. 
`panel.cor()`는 correlation coefficient를 구하는 함수입니다.
ETA와 covariate와의 관계를 나타낼 때도 쓰일 수 있습니다.

```{r message = FALSE}
library(dplyr)
library(tibble)

# calculation of cor
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(0, 1, 0, 1))
  r = (cor(x, y))
  txt <- format(c(r, 0.123456789), digits=digits)[1]
  txt <- paste(prefix, txt, sep="")
  if(missing(cex.cor)) cex <- 1.5
  text(0.5, 0.5, txt, cex = 1.5)
}

# Theoph dataset
Theoph_nca <- NonCompart::tblNCA(Theoph, key=c("Subject", "Wt"), dose=320, concUnit="mg/L") %>% 
  as.tibble() %>%
  mutate_all(funs(as.numeric)) %>% 
  select(Wt, CMAX, TMAX, AUCLST)

# Pair plot
pairs(Theoph_nca, 
      lower.panel=panel.smooth, 
      upper.panel=panel.cor) 
```
